<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian Analysis of Resampling Statistics — perf_mod • tidyposterior</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>
<link href="../tidyverse-2.css" rel="stylesheet">

<!--optional theme-->
<link href="../tidymodels.css" rel="stylesheet">




<meta property="og:title" content="Bayesian Analysis of Resampling Statistics — perf_mod" />
<meta property="og:description" content="Bayesian analysis used here to answer the question: &quot;when looking at
resampling results, are the differences between models 'real?'&quot; To answer
this, a model can be created were the outcome is the resampling statistics
(e.g. accuracy or RMSE). These values are explained by the model types. In
doing this, we can get parameter estimates for each model's affect on
performance and make statistical (and practical) comparisons between models." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">tidyposterior</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of <a href="https://tidymodels.org">tidymodels</a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.3</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../articles/articles/Getting_Started.html">Getting Started</a>
</li>
<li>
  <a href="../articles/Different_Bayesian_Models.html">Different Bayesian Models</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
        <li>
  <a href="https://github.com/tidymodels/tidyposterior/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian Analysis of Resampling Statistics</h1>
    <small class="dont-index">Source: <a href='https://github.com/tidymodels/tidyposterior/blob/master/R/perf_mod.R'><code>R/perf_mod.R</code></a></small>
    <div class="hidden name"><code>perf_mod.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Bayesian analysis used here to answer the question: "when looking at
resampling results, are the differences between models 'real?'" To answer
this, a model can be created were the <em>outcome</em> is the resampling statistics
(e.g. accuracy or RMSE). These values are explained by the model types. In
doing this, we can get parameter estimates for each model's affect on
performance and make statistical (and practical) comparisons between models.</p>
    </div>

    <pre class="usage"><span class='fu'>perf_mod</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for rset</span>
<span class='fu'>perf_mod</span><span class='op'>(</span><span class='va'>object</span>, transform <span class='op'>=</span> <span class='va'>no_trans</span>, hetero_var <span class='op'>=</span> <span class='cn'>FALSE</span>, formula <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for resamples</span>
<span class='fu'>perf_mod</span><span class='op'>(</span>
  <span class='va'>object</span>,
  transform <span class='op'>=</span> <span class='va'>no_trans</span>,
  hetero_var <span class='op'>=</span> <span class='cn'>FALSE</span>,
  metric <span class='op'>=</span> <span class='va'>object</span><span class='op'>$</span><span class='va'>metrics</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for data.frame</span>
<span class='fu'>perf_mod</span><span class='op'>(</span><span class='va'>object</span>, transform <span class='op'>=</span> <span class='va'>no_trans</span>, hetero_var <span class='op'>=</span> <span class='cn'>FALSE</span>, formula <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for tune_results</span>
<span class='fu'>perf_mod</span><span class='op'>(</span>
  <span class='va'>object</span>,
  metric <span class='op'>=</span> <span class='cn'>NULL</span>,
  transform <span class='op'>=</span> <span class='va'>no_trans</span>,
  hetero_var <span class='op'>=</span> <span class='cn'>FALSE</span>,
  formula <span class='op'>=</span> <span class='cn'>NULL</span>,
  filter <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for workflow_set</span>
<span class='fu'>perf_mod</span><span class='op'>(</span>
  <span class='va'>object</span>,
  metric <span class='op'>=</span> <span class='cn'>NULL</span>,
  transform <span class='op'>=</span> <span class='va'>no_trans</span>,
  hetero_var <span class='op'>=</span> <span class='cn'>FALSE</span>,
  formula <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>Depending on the context (see Details below):</p><ul>
<li><p>A data frame with <code>id</code> columns for the resampling groupds and metric
results in all of the other columns..</p></li>
<li><p>An <code>rset</code> object (such as <code><a href='https://rsample.tidymodels.org/reference/vfold_cv.html'>rsample::vfold_cv()</a></code>) containing the <code>id</code>
column(s) and at least two numeric columns of model performance
statistics (e.g. accuracy).</p></li>
<li><p>An object from <code>caret::resamples</code>.</p></li>
<li><p>An object with class <code>tune_results</code>, which could be produced by
<code><a href='https://tune.tidymodels.org/reference/tune_grid.html'>tune::tune_grid()</a></code>, <code><a href='https://tune.tidymodels.org/reference/tune_bayes.html'>tune::tune_bayes()</a></code> or similar.</p></li>
<li><p>A workflow set where all results contain the metric value given in the
<code>metric</code> argument value.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to pass to <code><a href='https://mc-stan.org/rstanarm/reference/stan_glmer.html'>rstanarm::stan_glmer()</a></code> such as
<code>verbose</code>, <code>prior</code>, <code>seed</code>, <code>refresh</code>, <code>family</code>, etc.</p></td>
    </tr>
    <tr>
      <th>transform</th>
      <td><p>An named list of transformation and inverse
transformation functions. See <code><a href='no_trans.html'>logit_trans()</a></code> as an example.</p></td>
    </tr>
    <tr>
      <th>hetero_var</th>
      <td><p>A logical; if <code>TRUE</code>, then different
variances are estimated for each model group. Otherwise, the
same variance is used for each group. Estimating heterogeneous
variances may slow or prevent convergence.</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>An optional model formula to use for the Bayesian hierarchical model
(see Details below).</p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p>A single character value for the statistic from
the <code>resamples</code> object that should be analyzed.</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>A conditional logic statement that can be used to filter the
statistics generated by <code>tune_results</code> using the tuning parameter values or
the <code>.config</code> column.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>perf_mod</code>. If a workfkow set is given in
<code>object</code>, there is an extra class of <code>"perf_mod_workflow_set"</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>These functions can be used to process and analyze matched
resampling statistics from different models using a Bayesian generalized
linear model with effects for the model and the resamples.</p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Bayesian Model formula</h3>


<p>By default, a generalized linear model with Gaussian error and an identity
link is fit to the data and has terms for the predictive model grouping
variable. In this way, the performance metrics can be compared between
models.</p>
<p>Additionally, random effect terms are also used. For most resampling
methods (except repeated <em>V</em>-fold cross-validation), a simple random
intercept model its used with an exchangeable (i.e. compound-symmetric)
variance structure. In the case of repeated cross-validation, two random
intercept terms are used; one for the repeat and another for the fold within
repeat. These also have exchangeable correlation structures.</p>
<p>The above model specification assumes that the variance in the performance
metrics is the same across models. However, this is unlikely to be true in
some cases. For example, for simple binomial accuracy, it well know that the
variance is highest when the accuracy is near 50 percent. When the argument
<code>hetero_var = TRUE</code>, the variance structure uses random intercepts for each
model term. This may produce more realistic posterior distributions but may
take more time to converge.</p>
<p>Examples of the default formulas are:</p>
<pre>
   <span class='co'># One ID field and common variance:</span>
     <span class='va'>statistic</span> <span class='op'>~</span> <span class='va'>model</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>model</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span>

   <span class='co'># One ID field and heterogeneous variance:</span>
     <span class='va'>statistic</span> <span class='op'>~</span> <span class='va'>model</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>model</span> <span class='op'>+</span> <span class='fl'>0</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span>

   <span class='co'># Repeated CV (id = repeat, id2 = fold within repeat)</span>
   <span class='co'># with a common variance:</span>
     <span class='va'>statistic</span> <span class='op'>~</span> <span class='va'>model</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>model</span> <span class='op'>|</span> <span class='va'>id2</span><span class='op'>/</span><span class='va'>id</span><span class='op'>)</span>

   <span class='co'># Repeated CV (id = repeat, id2 = fold within repeat)</span>
   <span class='co'># with a heterogeneous variance:</span>
     <span class='va'>statistic</span> <span class='op'>~</span> <span class='va'>model</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>model</span> <span class='op'>+</span> <span class='fl'>0</span><span class='op'>|</span> <span class='va'>id2</span><span class='op'>/</span><span class='va'>id</span><span class='op'>)</span>

   <span class='co'># Default for unknown resampling method and</span>
   <span class='co'># multiple ID fields:</span>
     <span class='va'>statistic</span> <span class='op'>~</span> <span class='va'>model</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>model</span> <span class='op'>|</span> <span class='va'>idN</span><span class='op'>/</span><span class='va'>..</span><span class='op'>/</span><span class='va'>id</span><span class='op'>)</span>
 </pre>

<p>Custom formulas should use <code>statistic</code> as the outcome variable and <code>model</code>
as the factor variable with the model names.</p>
<p>Also, as shown in the package vignettes, the Gaussian assumption make be
unrealistic. In this case, there are at least two approaches that can be
used. First, the outcome statistics can be transformed prior to fitting the
model. For example, for accuracy, the logit transformation can be used to
convert the outcome values to be on the real line and a model is fit to
these data. Once the posterior distributions are computed, the inverse
transformation can be used to put them back into the original units. The
<code>transform</code> argument can be used to do this.</p>
<p>The second approach would be to use a different error distribution from the
exponential family. For RMSE values, the Gamma distribution may produce
better results at the expense of model computational complexity. This can be
achieved by passing the <code>family</code> argument to <code>perf_mod</code> as one might with
the <code>glm</code> function.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Input formats</h3>


<p>There are several ways to give resampling results to the <code>perf_mod()</code> function. To
illustrate, here are some example objects using 10-fold cross-validation for a
simple two-class problem:<div class="r"></p><pre>   <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidymodels.tidymodels.org'>tidymodels</a></span><span class='op'>)</span>
   <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyposterior.tidymodels.org'>tidyposterior</a></span><span class='op'>)</span>
   <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidymodels/workflowsets'>workflowsets</a></span><span class='op'>)</span>

   <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>two_class_dat</span>, package <span class='op'>=</span> <span class='st'>"modeldata"</span><span class='op'>)</span>

   <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>
   <span class='va'>folds</span> <span class='op'>&lt;-</span> <span class='fu'>vfold_cv</span><span class='op'>(</span><span class='va'>two_class_dat</span><span class='op'>)</span>
</pre><p></div></p>
<p>We can define two different models (for simplicity, with no tuning parameters).<div class="r"></p><pre>   <span class='va'>logistic_reg_glm_spec</span> <span class='op'>&lt;-</span>
     <span class='fu'>logistic_reg</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
     <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>'glm'</span><span class='op'>)</span>

   <span class='va'>mars_earth_spec</span> <span class='op'>&lt;-</span>
     <span class='fu'>mars</span><span class='op'>(</span>prod_degree <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
     <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>'earth'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
     <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>'classification'</span><span class='op'>)</span>
</pre><p></div></p>
<p>For tidymodels, the <code><a href='https://tune.tidymodels.org/reference/fit_resamples.html'>tune::fit_resamples()</a></code> function can be used to estimate
performance for each model/resample:<div class="r"></p><pre>   <span class='va'>rs_ctrl</span> <span class='op'>&lt;-</span> <span class='fu'>control_resamples</span><span class='op'>(</span>save_workflow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

   <span class='va'>logistic_reg_glm_res</span> <span class='op'>&lt;-</span>
     <span class='va'>logistic_reg_glm_spec</span> <span class='op'>%&gt;%</span>
     <span class='fu'><a href='https://tune.tidymodels.org/reference/fit_resamples.html'>fit_resamples</a></span><span class='op'>(</span><span class='va'>Class</span> <span class='op'>~</span> <span class='va'>.</span>, resamples <span class='op'>=</span> <span class='va'>folds</span>, control <span class='op'>=</span> <span class='va'>rs_ctrl</span><span class='op'>)</span>

   <span class='va'>mars_earth_res</span> <span class='op'>&lt;-</span>
     <span class='va'>mars_earth_spec</span> <span class='op'>%&gt;%</span>
     <span class='fu'><a href='https://tune.tidymodels.org/reference/fit_resamples.html'>fit_resamples</a></span><span class='op'>(</span><span class='va'>Class</span> <span class='op'>~</span> <span class='va'>.</span>, resamples <span class='op'>=</span> <span class='va'>folds</span>, control <span class='op'>=</span> <span class='va'>rs_ctrl</span><span class='op'>)</span>
</pre><p></div></p>
<p>From these, there are several ways to pass the results to <code>perf_mod()</code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Data Frame as Input</h4>


<p>The most general approach is to have a data frame with the resampling labels (i.e.,
one or more id columns) as well as columns for each model that you would like to
compare.</p>
<p>For the model results above, <code><a href='https://tune.tidymodels.org/reference/collect_predictions.html'>tune::collect_metrics()</a></code> can be used along with some
basic data manipulation steps:<div class="r"></p><pre>   <span class='va'>logistic_roc</span> <span class='op'>&lt;-</span>
     <span class='fu'><a href='https://tune.tidymodels.org/reference/collect_predictions.html'>collect_metrics</a></span><span class='op'>(</span><span class='va'>logistic_reg_glm_res</span>, summarize <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
     <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>.metric</span> <span class='op'>==</span> <span class='st'>"roc_auc"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
     <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, logistic <span class='op'>=</span> <span class='va'>.estimate</span><span class='op'>)</span>

   <span class='va'>mars_roc</span> <span class='op'>&lt;-</span>
     <span class='fu'><a href='https://tune.tidymodels.org/reference/collect_predictions.html'>collect_metrics</a></span><span class='op'>(</span><span class='va'>mars_earth_res</span>, summarize <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
     <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>.metric</span> <span class='op'>==</span> <span class='st'>"roc_auc"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
     <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, mars <span class='op'>=</span> <span class='va'>.estimate</span><span class='op'>)</span>

   <span class='va'>resamples_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>full_join</a></span><span class='op'>(</span><span class='va'>logistic_roc</span>, <span class='va'>mars_roc</span>, by <span class='op'>=</span> <span class='st'>"id"</span><span class='op'>)</span>
   <span class='va'>resamples_df</span>
</pre><p></div></p><pre>   <span class='co'>## # A tibble: 10 x 3</span>
   <span class='co'>##   id     logistic  mars</span>
   <span class='co'>##   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;</span>
   <span class='co'>## 1 Fold01    0.908 0.875</span>
   <span class='co'>## 2 Fold02    0.904 0.917</span>
   <span class='co'>## 3 Fold03    0.924 0.938</span>
   <span class='co'>## 4 Fold04    0.881 0.881</span>
   <span class='co'>## 5 Fold05    0.863 0.864</span>
   <span class='co'>## 6 Fold06    0.893 0.889</span>
   <span class='co'>## # … with 4 more rows</span>
</pre>

<p>We can then give this directly to <code>perf_mod()</code>:<div class="r"></p><pre>   <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>101</span><span class='op'>)</span>
   <span class='va'>roc_model_via_df</span> <span class='op'>&lt;-</span> <span class='fu'>perf_mod</span><span class='op'>(</span><span class='va'>resamples_df</span>, refresh <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
   <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='va'>roc_model_via_df</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='op'>)</span>
</pre><p></div></p><pre>   <span class='co'>## # A tibble: 2 x 4</span>
   <span class='co'>##   model     mean lower upper</span>
   <span class='co'>##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
   <span class='co'>## 1 logistic 0.892 0.879 0.906</span>
   <span class='co'>## 2 mars     0.888 0.875 0.902</span>
</pre>


<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>rsample Object as Input</h4>


<p>Alternatively, the result columns can be merged back into the original <code>rsample</code>
object. The up-side to using this method is that <code>perf_mod()</code> will know exactly
which model formula to use for the Bayesian model:<div class="r"></p><pre>   <span class='va'>resamples_rset</span> <span class='op'>&lt;-</span>
     <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>full_join</a></span><span class='op'>(</span><span class='va'>folds</span>, <span class='va'>logistic_roc</span>, by <span class='op'>=</span> <span class='st'>"id"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
     <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>full_join</a></span><span class='op'>(</span><span class='va'>mars_roc</span>, by <span class='op'>=</span> <span class='st'>"id"</span><span class='op'>)</span>

   <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>101</span><span class='op'>)</span>
   <span class='va'>roc_model_via_rset</span> <span class='op'>&lt;-</span> <span class='fu'>perf_mod</span><span class='op'>(</span><span class='va'>resamples_rset</span>, refresh <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
   <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='va'>roc_model_via_rset</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='op'>)</span>
</pre><p></div></p><pre>   <span class='co'>## # A tibble: 2 x 4</span>
   <span class='co'>##   model     mean lower upper</span>
   <span class='co'>##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
   <span class='co'>## 1 logistic 0.892 0.879 0.906</span>
   <span class='co'>## 2 mars     0.888 0.875 0.902</span>
</pre>


<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Workflow Set Object as Input</h4>


<p>Finally, for tidymodels, a workflow set object can be used. This is a collection of
models/preprocessing combinations in one object. We can emulate a workflow set using
the existing example results then pass that to <code>perf_mod()</code>:<div class="r"></p><pre>   <span class='va'>example_wset</span> <span class='op'>&lt;-</span>
     <span class='fu'><a href='https://workflowsets.tidymodels.org/reference/as_workflow_set.html'>as_workflow_set</a></span><span class='op'>(</span>logistic <span class='op'>=</span> <span class='va'>logistic_reg_glm_res</span>, mars <span class='op'>=</span> <span class='va'>mars_earth_res</span><span class='op'>)</span>

   <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>101</span><span class='op'>)</span>
   <span class='va'>roc_model_via_wflowset</span> <span class='op'>&lt;-</span> <span class='fu'>perf_mod</span><span class='op'>(</span><span class='va'>example_wset</span>, refresh <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
   <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='va'>roc_model_via_rset</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='op'>)</span>
</pre><p></div></p><pre>   <span class='co'>## # A tibble: 2 x 4</span>
   <span class='co'>##   model     mean lower upper</span>
   <span class='co'>##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
   <span class='co'>## 1 logistic 0.892 0.879 0.906</span>
   <span class='co'>## 2 mars     0.888 0.875 0.902</span>
</pre>


<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>caret resamples object</h4>


<p>The <code>caret</code> package can also be used. An equivalent set of models are created:<div class="r"></p><pre>   <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>caret</span><span class='op'>)</span>

   <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>102</span><span class='op'>)</span>
   <span class='va'>logistic_caret</span> <span class='op'>&lt;-</span> <span class='fu'>train</span><span class='op'>(</span><span class='va'>Class</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>two_class_dat</span>, method <span class='op'>=</span> <span class='st'>"glm"</span>,
                           trControl <span class='op'>=</span> <span class='fu'>trainControl</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"cv"</span><span class='op'>)</span><span class='op'>)</span>

   <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>102</span><span class='op'>)</span>
   <span class='va'>mars_caret</span> <span class='op'>&lt;-</span> <span class='fu'>train</span><span class='op'>(</span><span class='va'>Class</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>two_class_dat</span>, method <span class='op'>=</span> <span class='st'>"gcvEarth"</span>,
                       tuneGrid <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>degree <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                       trControl <span class='op'>=</span> <span class='fu'>trainControl</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"cv"</span><span class='op'>)</span><span class='op'>)</span>
</pre><p></div></p>
<p>Note that these two models use the same resamples as one another due to setting the
seed prior to calling <code>train()</code>. However, these are different from the tidymodels
results used above (so the final results will be different).</p>
<p><code>caret</code> has a <code>resamples()</code> function that can collect and collate the resamples.
This can also be given to <code>perf_mod()</code>:<div class="r"></p><pre>   <span class='va'>caret_resamples</span> <span class='op'>&lt;-</span> <span class='fu'>resamples</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>logistic <span class='op'>=</span> <span class='va'>logistic_caret</span>, mars <span class='op'>=</span> <span class='va'>mars_caret</span><span class='op'>)</span><span class='op'>)</span>

   <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>101</span><span class='op'>)</span>
   <span class='va'>roc_model_via_caret</span> <span class='op'>&lt;-</span> <span class='fu'>perf_mod</span><span class='op'>(</span><span class='va'>caret_resamples</span>, refresh <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
   <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='va'>roc_model_via_caret</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='op'>)</span>
</pre><p></div></p><pre>   <span class='co'>## # A tibble: 2 x 4</span>
   <span class='co'>##   model     mean lower upper</span>
   <span class='co'>##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
   <span class='co'>## 1 logistic 0.821 0.801 0.842</span>
   <span class='co'>## 2 mars     0.822 0.802 0.842</span>
</pre>




    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kuhn and Silge (2021) <em>Tidy Models with R</em>, Chapter 11,
<a href='https://www.tmwr.org/compare.html'>https://www.tmwr.org/compare.html</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='tidy.perf_mod.html'>tidy.perf_mod()</a></code>, <code><a href='contrast_models.html'>contrast_models()</a></code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="tidyverse">
  <p>tidyposterior is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by Max Kuhn.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
   </div>

  


  </body>
</html>


